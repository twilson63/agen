# Application Specification JSON Schema

## Overview

This schema defines the declarative format for full-stack application specifications. The specification is generated by Tier 1 (Specification Generator) and consumed by Tier 2 (Application Renderer).

## Schema Version

Current version: `1.0.0`

```json
"$schema": "http://json-schema.org/draft-07/schema#",
"$id": "https://github.com/twilson63/agentic-app-generator/schemas/app-specification.json",
"title": "Application Specification",
"description": "Declarative specification for full-stack applications",
"version": "1.0.0"
```

## Complete Schema

```json
{
  "type": "object",
  "required": ["app", "stack"],
  "properties": {
    "app": {
      "$id": "#/properties/app",
      "type": "object",
      "title": "Application Metadata",
      "description": "Application identity and version information",
      "required": ["name", "version"],
      "properties": {
        "name": {
          "type": "string",
          "minLength": 1,
          "maxLength": 100,
          "pattern": "^[a-z0-9-]+$",
          "description": "Application name (kebab-case)",
          "examples": ["my-todo-app", "crm-service", "blog-platform"]
        },
        "description": {
          "type": "string",
          "maxLength": 500,
          "description": "Brief description of the application"
        },
        "version": {
          "type": "string",
          "pattern": "^\\d+\\.\\d+\\.\\d+$",
          "description": "Semantic version (major.minor.patch)",
          "examples": ["1.0.0", "0.5.2", "2.1.0"]
        },
        "author": {
          "type": "string",
          "description": "Application author/owner"
        },
        "license": {
          "type": "string",
          "default": "MIT",
          "description": "Software license"
        }
      }
    },
    "stack": {
      "$id": "#/properties/stack",
      "type": "object",
      "title": "Technology Stack",
      "description": "Choice of frameworks and technologies",
      "required": ["frontend", "backend", "database"],
      "properties": {
        "frontend": {
          "type": "object",
          "title": "Frontend Stack",
          "required": ["framework"],
          "properties": {
            "framework": {
              "type": "string",
              "enum": ["react", "vue", "svelte", "solid", "angular"],
              "description": "Frontend framework"
            },
            "language": {
              "type": "string",
              "enum": ["typescript", "javascript"],
              "default": "typescript",
              "description": "TypeScript or JavaScript"
            },
            "styling": {
              "type": "string",
              "enum": ["tailwind", "css", "styled-components", "emotion", "css-modules"],
              "default": "tailwind"
            },
            "router": {
              "type": "string",
              "enum": ["react-router", "vue-router", "svelte-router"],
              "description": "Routing library (if needed)"
            },
            "stateManagement": {
              "type": "string",
              "enum": ["redux", "zustand", "jotai", "pinia", "vuex", "svelte-store"],
              "description": "State management solution"
            }
          }
        },
        "backend": {
          "type": "object",
          "title": "Backend Stack",
          "required": ["framework"],
          "properties": {
            "framework": {
              "type": "string",
              "enum": ["express", "fastify", "nestjs", "koajs", "hapi"],
              "description": "Backend framework"
            },
            "language": {
              "type": "string",
              "enum": ["typescript", "javascript"],
              "default": "typescript"
            },
            "api": {
              "type": "string",
              "enum": ["rest", "graphql", "grpc"],
              "default": "rest"
            },
            "validation": {
              "type": "string",
              "enum": ["zod", "joi", "yup", "class-validator"],
              "default": "zod"
            }
          }
        },
        "database": {
          "type": "object",
          "title": "Database Stack",
          "required": ["type"],
          "properties": {
            "type": {
              "type": "string",
              "enum": ["postgresql", "mysql", "mongodb", "sqlite", "rethinkdb"],
              "description": "Database type"
            },
            "orm": {
              "type": "string",
              "enum": ["prisma", "sequelize", "typeorm", "mongoose", "knex"],
              "description": "ORM/Object Data Mapper"
            },
            "migrationTool": {
              "type": "string",
              "enum": ["prisma-migrate", "sequelize-cli", "typeorm-migration"],
              "description": "Migration tool (if applicable)"
            }
          }
        },
        "testing": {
          "type": "object",
          "title": "Testing Stack",
          "properties": {
            "unit": {
              "type": "string",
              "enum": ["jest", "vitest", "mocha", "jasmine"],
              "default": "vitest"
            },
            "e2e": {
              "type": "string",
              "enum": ["playwright", "cypress", "puppeteer"],
              "default": "playwright"
            }
          }
        },
        "deployment": {
          "type": "object",
          "title": "Deployment Configuration",
          "properties": {
            "hosting": {
              "type": "string",
              "enum": ["vercel", "netlify", "render", "aws", "gcp", "azure", "docker"],
              "description": "Deployment target"
            },
            "container": {
              "type": "boolean",
              "default": false,
              "description": "Use Docker containers"
            }
          }
        }
      }
    },
    "components": {
      "$id": "#/properties/components",
      "type": "array",
      "title": "Components",
      "description": "List of frontend components to generate",
      "items": {
        "type": "object",
        "required": ["name", "type", "path"],
        "properties": {
          "name": {
            "type": "string",
            "description": "Component name (PascalCase)"
          },
          "type": {
            "type": "string",
            "enum": ["ui", "feature", "page", "layout", "hoc"],
            "description": "Component category"
          },
          "path": {
            "type": "string",
            "description": "File path relative to src/"
          },
          "description": {
            "type": "string",
            "description": "Component purpose"
          },
          "variant": {
            "type": "string",
            "description": "Component variant/style"
          },
          "props": {
            "type": "object",
            "description": "Component properties"
          },
          "state": {
            "type": "object",
            "description": "React state/refs if needed"
          },
          "hooks": {
            "type": "array",
            "items": {
              "type": "string",
              "enum": ["useState", "useEffect", "useMemo", "useCallback", "useRef", "useContext", "useReducer"]
            },
            "description": "React hooks to use"
          }
        }
      }
    },
    "pages": {
      "$id": "#/properties/pages",
      "type": "array",
      "title": "Pages",
      "description": "Application pages/routes",
      "items": {
        "type": "object",
        "required": ["path", "name", "components"],
        "properties": {
          "name": {
            "type": "string",
            "description": "Page name"
          },
          "path": {
            "type": "string",
            "pattern": "^/",
            "description": "Route path (e.g., /dashboard, /users/:id)"
          },
          "title": {
            "type": "string",
            "description": "Page title"
          },
          "layout": {
            "type": "string",
            "description": "Layout to use"
          },
          "auth": {
            "type": "boolean",
            "default": false,
            "description": "Require authentication"
          },
          "components": {
            "type": "array",
            "items": {
              "type": "string"
            },
            "description": "Components to include on page"
          }
        }
      }
    },
    "routes": {
      "$id": "#/properties/routes",
      "type": "array",
      "title": "Backend Routes",
      "description": "API endpoints",
      "items": {
        "type": "object",
        "required": ["path", "method", "handler"],
        "properties": {
          "path": {
            "type": "string",
            "description": "API path (e.g., /api/users, /api/todos)"
          },
          "method": {
            "type": "string",
            "enum": ["GET", "POST", "PUT", "PATCH", "DELETE"],
            "description": "HTTP method"
          },
          "handler": {
            "type": "string",
            "description": "Handler function name"
          },
          "description": {
            "type": "string",
            "description": "What this route does"
          },
          "auth": {
            "type": "boolean",
            "default": false,
            "description": "Require authentication"
          },
          "role": {
            "type": "string",
            "description": "Required role (if auth is true)"
          },
          "validation": {
            "type": "object",
            "description": "Request validation schema"
          },
          "response": {
            "type": "object",
            "description": "Response schema"
          }
        }
      }
    },
    "database": {
      "$id": "#/properties/database",
      "type": "object",
      "title": "Database Schema",
      "properties": {
        "models": {
          "type": "array",
          "title": "Database Models",
          "items": {
            "type": "object",
            "required": ["name", "fields"],
            "properties": {
              "name": {
                "type": "string",
                "description": "Model/table name (PascalCase converted to snake_case)"
              },
              "description": {
                "type": "string",
                "description": "Model purpose"
              },
              "fields": {
                "type": "array",
                "title": "Fields",
                "items": {
                  "type": "object",
                  "required": ["name", "type"],
                  "properties": {
                    "name": {
                      "type": "string",
                      "description": "Field name (camelCase)"
                    },
                    "type": {
                      "type": "string",
                      "enum": ["string", "number", "boolean", "date", "json"] 
                    },
                    "required": {
                      "type": "boolean",
                      "default": false
                    },
                    "unique": {
                      "type": "boolean",
                      "default": false
                    },
                    "indexed": {
                      "type": "boolean",
                      "default": false
                    },
                    "default": {
                      "description": "Default value"
                    },
                    "ref": {
                      "type": "string",
                      "description": "Reference to another model (e.g., User.id)"
                    },
                    "description": {
                      "type": "string"
                    }
                  }
                }
              }
            }
          }
        },
        "seed": {
          "type": "array",
          "title": "Seed Data",
          "description": "Initial data to populate the database",
          "items": {
            "type": "object"
          }
        }
      }
    },
    "styling": {
      "$id": "#/properties/styling",
      "type": "object",
      "title": "Styling Configuration",
      "properties": {
        "theme": {
          "type": "string",
          "enum": ["light", "dark", "system"],
          "default": "system",
          "description": "Default theme"
        },
        "primaryColor": {
          "type": "string",
          "pattern": "^#[0-9A-Fa-f]{6}$",
          "default": "#3B82F6"
        },
        "secondaryColor": {
          "type": "string",
          "pattern": "^#[0-9A-Fa-f]{6}$",
          "default": "#6B7280"
        },
        "borderRadius": {
          "type": "string",
          "default": "0.5rem"
        },
        "fonts": {
          "type": "object",
          "properties": {
            "primary": {
              "type": "string"
            },
            "secondary": {
              "type": "string"
            },
            "code": {
              "type": "string"
            }
          }
        }
      }
    },
    "features": {
      "$id": "#/properties/features",
      "type": "object",
      "title": "Features",
      "description": "Optional features to include",
      "properties": {
        "authentication": {
          "type": "boolean",
          "default": false
        },
        "userManagement": {
          "type": "boolean",
          "default": false
        },
        "roleBasedAccess": {
          "type": "boolean",
          "default": false
        },
        "emailVerification": {
          "type": "boolean",
          "default": false
        },
        "fileUpload": {
          "type": "boolean",
          "default": false
        },
        "notifications": {
          "type": "boolean",
          "default": false
        },
        "logging": {
          "type": "boolean",
          "default": true
        },
        "apiDocs": {
          "type": "boolean",
          "default": true
        },
        "docker": {
          "type": "boolean",
          "default": false
        }
      }
    },
    "environment": {
      "$id": "#/properties/environment",
      "type": "object",
      "title": "Environment Variables",
      "properties": {
        "required": {
          "type": "array",
          "items": {
            "type": "object",
            "properties": {
              "name": {
                "type": "string"
              },
              "description": {
                "type": "string"
              },
              "default": {
                "description": "Default value template"
              }
            }
          }
        }
      }
    }
  }
}
```

## Example Specification

```json
{
  "app": {
    "name": "todo-app",
    "description": "A simple task management application",
    "version": "1.0.0",
    "author": "twilson63",
    "license": "MIT"
  },
  "stack": {
    "frontend": {
      "framework": "react",
      "language": "typescript",
      "styling": "tailwind",
      "router": "react-router",
      "stateManagement": "zustand"
    +},
    "backend": {
      "framework": "express",
      "language": "typescript",
      "api": "rest",
      "validation": "zod"
    },
    "database": {
      "type": "postgresql",
      "orm": "prisma",
      "migrationTool": "prisma-migrate"
    },
    "testing": {
      "unit": "vitest",
      "e2e": "playwright"
    },
    "deployment": {
      "hosting": "render",
      "container": false
    }
  },
  "components": [
    {
      "name": "TodoForm",
      "type": "feature",
      "path": "components/TodoForm",
      "description": "Form to add new todos",
      "props": {
        "onAdd": "function"
      }
    },
    {
      "name": "TodoList",
      "type": "ui",
      "path": "components/TodoList",
      "description": "List of todo items",
      "props": {
        "todos": "array",
        "onToggle": "function",
        "onDelete": "function"
      }
    }
  ],
  "pages": [
    {
      "name": "Home",
      "path": "/",
      "title": "Todos",
      "components": ["TodoForm", "TodoList"],
      "auth": false
    }
  ],
  "routes": [
    {
      "path": "/api/todos",
      "method": "GET",
      "handler": "getTodos",
      "auth": true
    },
    {
      "path": "/api/todos",
      "method": "POST",
      "handler": "createTodo",
      "auth": true,
      "validation": {
        "title": "string (required)",
        "completed": "boolean"
      }
    }
  ],
  "database": {
    "models": [
      {
        "name": "Todo",
        "description": "Todo items",
        "fields": [
          {
            "name": "id",
            "type": "string",
            "required": true,
            "unique": true
          },
          {
            "name": "title",
            "type": "string",
            "required": true
          },
          {
            "name": "completed",
            "type": "boolean",
            "default": false
          },
          {
            "name": "createdAt",
            "type": "date",
            "required": true
          }
        ]
      }
    ]
  },
  "styling": {
    "theme": "system",
    "primaryColor": "#3B82F6"
  },
  "features": {
    "authentication": true,
    "logging": true,
    "apiDocs": true
  }
}
```

## Usage

### Validate Specification

```javascript
import { validateSpec } from './config-schemas/schema-validator.mjs';

const spec = { /* your spec */ };
const { valid, errors } = validateSpec(spec);

if (!valid) {
  console.error('Invalid specification:', errors);
}
```

### Generate from Specification

```javascript
import { Renderer } from './tier2-renderer/index.mjs';

const renderer = new Renderer({
  spec: myAppSpec,
  output: './my-app'
});

await renderer.generate();
```

## Validation Rules

- `app.name`: Must be kebab-case, 1-100 characters
- `app.version`: Must follow semantic versioning (X.Y.Z)
- `stack.frontend.framework`: Must be supported framework
- `components[*].name`: Must be PascalCase
- `routes[*].path`: Must start with `/`
- `database.models[*].fields[*].type`: Must be valid type

---

This schema is consumed by Tier 2 renderer to generate working full-stack applications.